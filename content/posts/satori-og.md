---
title: –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–≤—å—é —Å –ø–æ–º–æ—â—å—é Satori
tags:
  - open-graph
  - web
  - backend
  - nuxt
description: >
  –í –¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–± –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–≤—å—é —Å –ø–æ–º–æ—â—å—é Satori. Satori - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Vercel, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è
  —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–µ–≤—Ä–∞—â–∞—Ç—å HTML-–≤–µ—Ä—Å—Ç–∫—É –≤ SVG –∫–∞—Ä—Ç–∏–Ω–∫–∏. –° –ø–æ–º–æ—â—å—é –¥–∞–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º—ã –±—É–¥–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
  Open Graph –ø—Ä–µ–≤—å—é –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü. –í –¥–∞–Ω–Ω–æ–º –±–ª–æ–≥–µ –ø—Ä–µ–≤—å—é —Å–¥–µ–ª–∞–Ω—ã –∏–º–µ–Ω–Ω–æ –ø–æ —ç—Ç–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É, —Ç–∞–∫ —á—Ç–æ –≤–ø–µ—Ä–µ–¥ –ø–æ–¥ –∫–∞—Ç :)
date: 2023-04-08
origin:
  type: vc
  url: https://vc.ru/dev/661531-avtogeneraciya-prevyu-s-pomoshchyu-satori
---

–£ –∫–∞–∂–¥–æ–≥–æ —Å–∞–π—Ç–∞ –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–µ–≥–∏ - [Open Graph](https://www.ogp.me), –æ–Ω–∏ –Ω—É–∂–Ω—ã –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ–∏—Å–∫–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª–∏
–≤—ã–¥–∞—á—É –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ —Å–∞–º–æ–º –ø–æ–∏—Å–∫–µ. –¢–∞–∫–∂–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–≥–∏ –Ω—É–∂–Ω—ã –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å—Å—ã–ª–∫–∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã –º–æ–≥–ª–∏
–ø–æ–¥—Ç—è–Ω—É—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –ø—Ä–µ–≤—å—é –¥–ª—è —Å–∞–π—Ç–∞.

–¢–µ–º–∞ OG –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—É—Ç–∞–Ω–∞, –æ–¥–Ω–∞–∫–æ —Å–µ–π—á–∞—Å –º—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è —Ä–∞–∑–ª–æ–∂–∏—Ç—å –≤—Å–µ –ø–æ –ø–æ–ª–æ—á–∫–∞–º. Open Graph-—Ç–µ–≥–∏ –≤—ã–≥–ª—è–¥—è—Ç —Å–ª–µ–¥—É—é—â–∏–º
–æ–±—Ä–∞–∑–æ–º:

```html[open-graph-head.html] –ë–∞–∑–æ–≤—ã–µ Open Graph-—Ç–µ–≥–∏
<meta property="og:title" content="–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–∞–π—Ç–∞" />
<meta property="og:description" content="–û–ø–∏—Å–∞–Ω–∏–µ —Å–∞–π—Ç–∞" />
<meta property="og:image" content="–°—Å—ã–ª–∫–∞ –∫ –ø—Ä–µ–≤—å—é" />
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `og:image` –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å —Ñ–æ—Ä–º–∞—Ç–æ–º `.jpg, .png`. –ù–∞–º –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —ç—Ç–∏—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ —Å –ø–æ–º–æ—â—å—é
API.

> –î–∞–ª–µ–µ –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ä–∞–±–æ—á–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ Nuxt

# –ü—Ä–∏–Ω—Ü–∏–ø –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–≤—å—é

–ü—Ä–∏–Ω—Ü–∏–ø –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–µ–≤—å—é —Å–ª–µ–¥—É—é—â–∏–π:
1. –ú—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ–º–ø–ª–µ–π—Ç —Å –ø–æ–º–æ—â—å—é [satori-html](https://www.npmjs.com/package/satori-html), –æ–Ω –Ω—É–∂–µ–Ω –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –∑–∞—Ç–µ–º –º—ã –ø–µ—Ä–µ–≤–µ–ª–∏ –µ–≥–æ –≤ SVG-—Ñ–æ—Ä–º–∞—Ç;
2. –ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–º–ø–ª–µ–π—Ç–∞ - –Ω–∞–º –Ω—É–∂–Ω–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ svg-—Ñ–æ—Ä–º–∞—Ç. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é [satori](https://github.com/vercel/satori);
3. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –º—ã –ø–æ–ª—É—á–∏–ª–∏ svg-—Ñ–æ—Ä–º–∞—Ç –Ω–∞—à–µ–≥–æ —Ç–µ–º–ø–ª–µ–π—Ç–∞ - –º—ã –º–æ–∂–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ png/jpg. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é
   [resvg-js](https://github.com/yisibl/resvg-js?ysclid=lgakhbuhhk179171891) –∏–ª–∏ [sharp](https://github.com/lovell/sharp);
4. –ú—ã –¥–µ–ª–∞–µ–º API, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –±—É–¥–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É. –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω—ã —á–µ—Ä–µ–∑ GET Query;
5. –ú—ã –¥–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –¥–∞–Ω–Ω–æ–µ API –≤ –º–µ—Ç–∞-—Ç–µ–≥ —Å `property="og:image"`, —É–∫–∞–∑—ã–≤–∞—è –≤–Ω—É—Ç—Ä–∏ GET Query –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø—Ä–µ–≤—å—é;
6. –í–Ω—É—Ç—Ä–∏ API –º—ã –±–µ—Ä–µ–º GET-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º –∏—Ö. –ö –ø—Ä–∏–º–µ—Ä—É –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –±–ª–æ–≥–∞ –Ω—É–∂–Ω—ã –±—ã–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
    ```yaml
    title: "–ó–∞–≥–æ–ª–æ–≤–æ–∫"
    subtitle: "–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫"
    description: "–û–ø–∏—Å–∞–Ω–∏–µ"
    url: "–°—Å—ã–ª–∫–∞"
    gradient: "–¶–≤–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞"
    ```
7. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ–º–ø–ª–µ–π—Ç –≤–Ω—É—Ç—Ä–∏ API, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –µ–≥–æ, –æ—Ç–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.


# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è VDOM-—Ç–µ–º–ø–ª–µ–π—Ç–∞
–ö–∞–∫ –º—ã —É–∂–µ –≥–æ–≤–æ—Ä–∏–ª–∏ –¥–æ —ç—Ç–æ–≥–æ - –Ω–∞–º –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–ø–ª–µ–π—Ç —Å –ø–æ–º–æ—â—å—é satori-html. –°–∞–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–º–ø–ª–µ–π—Ç–∞ —Ç–æ–∂–µ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–µ–π:
1. –ù–∞–ø–∏—Å–∞—Ç—å —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—é;
2. –ù–∞–ø–∏—Å–∞—Ç—å –≤–µ—Ä—Å—Ç–∫—É;
3. –î–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–¥—É—Ç —Å API;
4. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–ª–µ–π—Ç.

–°–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª `previewTemplate.ts`, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ–º –ø–∏—Å–∞—Ç—å –Ω–∞—à —Ç–µ–º–ø–ª–µ–π—Ç.

## –¢–∏–ø–∏–∑–∞—Ü–∏—è
–°–ø–µ—Ä–≤–∞ –º—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –æ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏. –í –º–æ–µ–º —Ç–µ–º–ø–ª–µ–π—Ç–µ –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫, –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ url. –í—Å–µ —ç—Ç–æ –±—É–¥–µ—Ç –Ω–∞ —Ñ–æ–Ω–µ
–≥—Ä–∞–¥–∏–µ–Ω—Ç–∞, –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã –±—É–¥–µ–º –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `gradient`.

–¢–∞–∫–∂–µ –Ω–∞–º –Ω—É–∂–Ω–∞ —Å—Ö–µ–º–∞ –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–∏—à–ª–∏ –ª–∏ –Ω–∞–º –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ GET-–∑–∞–ø—Ä–æ—Å–µ. –ú—ã –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é
Zod.

::ContentBookmark{url="https://github.com/colinhacks/zod"}
::

```typescript[preview.types.ts]
import { z } from "zod";

export type PreviewGradientColor = "pink" |
  "red" |
  "green" |
  "blue" |
  "rainbow" |
  "yellow" |
  "orange" |
  "purple" |
  "black";

export interface PreviewTemplate {
  title: string;
  subtitle?: string;
  description: string;
  url: string;
  gradient?: PreviewGradientColor;
}

export const previewTemplateSchema = {
  title: z.string(),
  subtitle: z.optional(z.string()),
  description: z.string(),
  url: z.string(),
  gradient: z.optional(z.string()),
};
```

## –°—Ç–∏–ª–∏
–ù–∞—á–Ω–µ–º —Å–æ —Å—Ç–∏–ª–µ–π. –ü–µ—Ä–≤–æ–µ —á—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å (–æ–±–æ —á—Ç–æ –ª–∏—á–Ω–æ —è —Å–ø–æ—Ç–∫–Ω—É–ª—Å—è) - satori –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é CSS-—Å–≤–æ–π—Å—Ç–≤.
[–û–Ω–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –∑–¥–µ—Å—å](https://github.com/vercel/satori#css).

–í–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ `previewTemplate.ts` —Å–æ–∑–¥–∞–¥–∏–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å–µ–±–µ —Å—Ç–∏–ª–∏:

```typescript[previewTemplate.ts] –ü–∏—à–µ–º —Å—Ç–∏–ª–∏
// Styles for the template
// Docs: https://github.com/vercel/satori#css
const STYLE = {
  main: `
    display: flex;
    font-family: Manrope, sans-serif;
    justify-content: space-between;
    padding: 120px;
    align-items: center;
    height: 100vh;
    gap: 320px;
  `,
  blockInfo: `
    display: flex;
    flex-direction: column;
    gap: 32px;
  `,
  title: `
    font-size: 72px;
    font-weight: 700;
    white-space: pre-wrap;
  `,
  subtitle: `
    font-size: 44px;
    font-weight: 600;
    white-space: pre-wrap;
    font-family: "JetBrainsMono";
    text-decoration: underline;
    text-decoration-style: dashed;
    padding-bottom: 8px;
  `,
  description: `
    font-size: 32px;
  `,
  url: `
    display: flex;
    font-size: 18px;
  `,
  logo: `
    text-align: left;
    font-family: 'JetBrainsMono', monospace;
    font-weight: 400;
  `
};
```

–¢–∞–∫–∂–µ –ª–∏—á–Ω–æ –º–Ω–µ –Ω—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `gradient` - –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç (—É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ).

–î–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```typescript[previewTemplate.ts]
/**
 * Utility for generation gradients
 * @param color Primary color of gradient
 */
const getGradientCss = (color: PreviewGradientColor) => {

  // Colors for fonts
  const BLACK_COLOR = "#222222";
  const WHITE_COLOR = "#f8f8f8";

  switch (color) {
    case "red":
      return `
        background-image: linear-gradient(90deg, rgb(242, 132, 105) 0%, rgb(255, 82, 131) 100%);
        color: ${WHITE_COLOR};
      `;
    case "pink":
      return `
        background-image: linear-gradient(45deg, rgba(255,191,217,1) 0%, rgba(194,255,193,1) 100%);
        color: ${BLACK_COLOR};
      `;
    case "orange":
      return `
        background-image: linear-gradient(77deg, rgba(247,217,171,1) 0%, rgba(221,111,128,1) 100%);
        color: ${WHITE_COLOR};
      `;
    case "black":
      return `
        background-image: linear-gradient(162deg, rgba(0,0,0,1) 0%, rgba(83,83,83,1) 100%);
        color: ${WHITE_COLOR};
      `;
    case "purple":
      return `
        background-image: linear-gradient(90deg, #efd5ff 0%, #515ada 100%);
        color: ${BLACK_COLOR};
      `;
    case "yellow":
      return `
        background-image: linear-gradient(143deg, rgba(255,239,145,1) 0%, rgba(181,255,143,1) 100%);
        color: ${BLACK_COLOR};
      `;
    case "green":
      return `
         background-image: linear-gradient(45deg, rgba(145,173,255,1) 0%, rgba(145,255,143,1) 100%);
         color: ${BLACK_COLOR};
      `;
    case "rainbow":
      return `
        background-image:
          linear-gradient(
            108.4deg,
            rgba(250,236,190,1) 4.2%,
            rgba(247,202,205,1) 30.7%,
            rgba(255,186,233,1) 53.9%,
            rgba(214,176,214,1) 73.9%,
            rgba(148,195,231,1) 90.4%
          );
        color: ${BLACK_COLOR};
      `;
    default: // Blue
      return `
        background-image: linear-gradient(to right, #a8c0ff, #3f2b96);
        color: ${WHITE_COLOR};
      `;
  }
};
```

## –¢–µ–º–ø–ª–µ–π—Ç
–¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∞–º —Ç–µ–º–ø–ª–µ–π—Ç. –ú—ã –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é satori-html, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å HTML-—Å—Ç—Ä–æ–∫—É,
–Ω–∞ –≤—ã—Ö–æ–¥–µ –º—ã –ø–æ–ª—É—á–∏–º VDOM, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≤–º–µ—Å—Ç–∏–º —Å satori.

–°–∞–º —Ç–µ–º–ø–ª–µ–π—Ç –º—ã –±—É–¥–µ–º –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `generatePreviewTemplate`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```tsx[previewTemplate.ts]
const generatePreviewTemplate = ({ title, subtitle, description, url, gradient = "red" }: PreviewTemplate) => {
  const template = `
  <div
    style="${STYLE.main} ${getGradientCss(gradient)};"
  >
    <div style="${STYLE.blockInfo}">
      <div style="${STYLE.title}">${title}</div>
      ${subtitle && `<div style="${STYLE.subtitle}">${subtitle}</div>`}
      <div style="${STYLE.description}">${description}</div>
      <pre style="${STYLE.logo}">${FULL_LOGO_PREVIEW}</pre>
      <div style="${STYLE.url}">${url}</div>
    </div>
  </div>
  `;

  return html(template);
};
```

# API
–¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–Ω—É—Ç—Ä–∏ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–ø–ª–µ–π—Ç, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ svg, –∞ –∑–∞—Ç–µ–º –∏ –≤ png.

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å API –≤ Nuxt –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `server/api` –∏ –¥–æ–±–∞–≤–∏—Ç—å —Ç—É–¥–∞ —Ñ–∞–π–ª, –∏–º—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∏ –±—É–¥–µ—Ç
—è–≤–ª—è—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º, –≤ –º–æ–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ `og.get.ts`, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ `/api/og`.

–î–∞–ª–µ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω –ª–∏—Å—Ç–∏–Ω–≥ —Å –ø–æ–ª–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º `og.get.ts`, –Ω–µ –ø—É–≥–∞–π—Ç–µ—Å—å –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–≥–æ –∫–æ–¥–∞, –Ω–∏–∂–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º
–≤—Å–µ –ø–æ—ç—Ç–∞–ø–Ω–æ:

```typescript[og.get.ts]
import satori, { FontWeight } from "satori";
import generatePreviewTemplate from "@d/previewTemplate";
import { getFontUrl } from "~/utils/fontPath";
import { OPEN_GRAPH_PREVIEW_SIZE } from "@/constants/openGraph";
import type { Fonts } from "@/types/fonts.types";
import { PreviewGradientColor, previewTemplateSchema } from "@/types/preview.types";
import { useSafeValidatedQuery } from "h3-zod";
import { Resvg } from "@resvg/resvg-js";

interface Font {
  name: Capitalize<Fonts>,
  weight: FontWeight,
  style: "normal" | "italic",
  data: ArrayBuffer
}

export default defineEventHandler(async (event) => {

  // Fonts
  const manropeNormalFont: Font = {
    name: "Manrope",
    data: await fetch(getFontUrl("manrope", "400"))
      .then(response => response.arrayBuffer()),
    weight: 400,
    style: "normal"
  };
  const manropeBoldFont: Font = {
    name: "Manrope",
    data: await fetch(getFontUrl("manrope", "700"))
      .then(response => response.arrayBuffer()),
    weight: 700,
    style: "normal"
  };
  const jetbrainsMonoRegular: Font = {
    name: "JetbrainsMono",
    data: await fetch(getFontUrl("jetbrainsMono", "400"))
      .then(response => response.arrayBuffer()),
    weight: 400,
    style: "normal"
  };
  const jetbrainsMonoSemi: Font = {
    name: "JetbrainsMono",
    data: await fetch(getFontUrl("jetbrainsMono", "600"))
      .then(response => response.arrayBuffer()),
    weight: 600,
    style: "normal"
  };


  // Validation of GET query
  const query = await useSafeValidatedQuery(event, previewTemplateSchema);

  if (!query.success) {
    return "400! Bad Request :(";
  }

  const template = generatePreviewTemplate({
    title: decodeURIComponent(query.data.title),
    subtitle: decodeURIComponent(query.data.subtitle ?? ""),
    description: decodeURIComponent(query.data.description),
    url: decodeURIComponent(query.data.url).replaceAll(/[\\{2}"]/g, ""),
    gradient: query.data.gradient as PreviewGradientColor ??
      "red"
  });

  const svg = await satori(template, {
    ...OPEN_GRAPH_PREVIEW_SIZE,
    fonts: [
      manropeNormalFont,
      manropeBoldFont,
      jetbrainsMonoRegular,
      jetbrainsMonoSemi,
    ]
  });

  const resvg = new Resvg(Buffer.from(svg));
  const pngBuffer = resvg.render().asPng();
  return send(event, pngBuffer, "image/png");
});
```

## –ò–º–ø–æ—Ä—Ç—ã
–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏:

```typescript
import satori, { FontWeight } from "satori";
import generatePreviewTemplate from "@d/previewTemplate";
import { getFontUrl } from "~/utils/fontPath";
import { OPEN_GRAPH_PREVIEW_SIZE } from "@/constants/openGraph";
import type { Fonts } from "@/types/fonts.types";
import { PreviewGradientColor, previewTemplateSchema } from "@/types/preview.types";
import { useSafeValidatedQuery } from "h3-zod";
import { Resvg } from "@resvg/resvg-js";
```

1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è `satori` –∏ `FontWeight`. –ü–µ—Ä–≤—ã–π –Ω—É–∂–µ–Ω –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å svg, –≤—Ç–æ—Ä–æ–π –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å
  –∂–∏—Ä–Ω–æ—Å—Ç—å —à—Ä–∏—Ñ—Ç–∞. Satori –Ω—É–∂–µ–Ω —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —à—Ä–∏—Ñ—Ç –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –∑–∞—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç–µ–º–ø–ª–µ–π—Ç –≤ svg;
2. `generatePreviewTemplate` –Ω—É–∂–µ–Ω –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å VDOM-–¥–µ—Ä–µ–≤–æ (—Ç–µ–º–ø–ª–µ–π—Ç), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å Satori;
3. `getFontUrl` –Ω—É–∂–µ–Ω –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –¥–æ—Å—Ç–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —à—Ä–∏—Ñ—Ç—É;
4. `OPEN_GRAPH_PREVIEW_SIZE` - –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Å —Ä–∞–∑–º–µ—Ä–æ–º –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –ø—Ä–µ–≤—å—é. –ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç - 1200px x 630px;
5. `Fonts` - —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è —à—Ä–∏—Ñ—Ç–æ–≤. –ï–µ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å
  [–≤–æ—Ç —Ç—É—Ç](https://github.com/tokiory/station/blob/master/types/fonts.types.ts);
6. `PreviewGradientColor` –∏ `previewTemplateSchema` –Ω—É–∂–Ω—ã –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É GET-–∑–∞–ø—Ä–æ—Å–∞;
7. `useSafeValidatedQuery` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏—à–ª–∏ –ª–∏ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ GET-–∑–∞–ø—Ä–æ—Å–µ, –∏—Å—Ö–æ–¥—è –∏–∑ zod-—Å—Ö–µ–º—ã;
8. `Resvg` - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑ svg –≤ png.

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —à—Ä–∏—Ñ—Ç–æ–≤
–ú—ã —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞–µ–º —Å–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —à—Ä–∏—Ñ—Ç–æ–≤, –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –∏—Ö –±—ã–ª–æ —É–¥–æ–±–Ω–µ–µ –ø–∏—Å–∞—Ç—å, —Ç–∏–ø–∏–∑–∏—Ä—É—è –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç:

```typescript
interface Font {
  name: Capitalize<Fonts>,
  weight: FontWeight,
  style: "normal" | "italic",
  data: ArrayBuffer
}
```

## –®—Ä–∏—Ñ—Ç—ã
–î–∞–ª–µ–µ –º—ã –¥–æ—Å—Ç–∞–µ–º –Ω—É–∂–Ω—ã–µ –Ω–∞–º —à—Ä–∏—Ñ—Ç—ã. –û–Ω–∏ –≤—Å–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ svg —Å –ø–æ–º–æ—â—å—é Satori.

> **–í–∞–∂–Ω–æ**. –ù—É–∂–Ω–æ –¥–æ—Å—Ç–∞—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –¥–ª—è —à—Ä–∏—Ñ—Ç–æ–≤:
> - `dev`: `http://localhost:3000/fonts/manrope/Manrope-Regular.ttf`,
> - `prod`: `https://tokiory.vercel.app/fonts/manrope/Manrope-Regular.ttf`.

–í—Å–µ —à—Ä–∏—Ñ—Ç—ã –∫–∞–∫ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –º—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤ `arrayBuffer` –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è. –≠—Ç–æ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –∏—Ö Satori.

```typescript
// Fonts
const manropeNormalFont: Font = {
  name: "Manrope",
  data: await fetch(getFontUrl("manrope", "400"))
    .then(response => response.arrayBuffer()),
  weight: 400,
  style: "normal"
};
const manropeBoldFont: Font = {
  name: "Manrope",
  data: await fetch(getFontUrl("manrope", "700"))
    .then(response => response.arrayBuffer()),
  weight: 700,
  style: "normal"
};
const jetbrainsMonoRegular: Font = {
  name: "JetbrainsMono",
  data: await fetch(getFontUrl("jetbrainsMono", "400"))
    .then(response => response.arrayBuffer()),
  weight: 400,
  style: "normal"
};
const jetbrainsMonoSemi: Font = {
  name: "JetbrainsMono",
  data: await fetch(getFontUrl("jetbrainsMono", "600"))
    .then(response => response.arrayBuffer()),
  weight: 600,
  style: "normal"
};
```

## –í–∞–ª–∏–¥–∞—Ü–∏—è GET-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–î–∞–ª–µ–µ –º—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–∞—à GET-–∑–∞–ø—Ä–æ—Å –∏ –≤—ã—Ü–µ–ø–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ï—Å–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç - —Ç–æ `useSafeValidatedQuery` –≤–µ—Ä–Ω–µ—Ç `{success: false, error: Error}`.

```typescript
// Validation of GET query
const query = await useSafeValidatedQuery(event, previewTemplateSchema);
if (!query.success) {
  return "400! Bad Request :(";
}
```

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–º–ø–ª–µ–π—Ç–∞
–¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–ø–ª–µ–π—Ç, –º—ã –¥–µ–ª–∞–µ–º —ç—Ç–æ –∏—Å—Ö–æ–¥—è –∏–∑ –Ω–∞—à–∏—Ö GET-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

```typescript
const template = generatePreviewTemplate({
  title: decodeURIComponent(query.data.title),
  subtitle: decodeURIComponent(query.data.subtitle ?? ""),
  description: decodeURIComponent(query.data.description),
  url: decodeURIComponent(query.data.url).replaceAll(/[\\{2}"]/g, ""),
  gradient: query.data.gradient as PreviewGradientColor ??
    "red"
});
```

–ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å —Ç—É—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `decodeURIComponent` - –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
–ß—É—Ç—å –¥–∞–ª—å—à–µ (–∫–æ–≥–¥–∞ –±—É–¥–µ–º –ø–∏—Å–∞—Ç—å composable) –º—ã —É–≤–∏–¥–∏–º –ø–æ—á–µ–º—É –∏—Ö –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å.

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è svg –∏ png
–¢–µ–ø–µ—Ä—å –¥–µ–ª–æ –∑–∞ –º–∞–ª—ã–º - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å svg, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ png –∏ –æ—Ç–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:

```typescript
const svg = await satori(template, {
  ...OPEN_GRAPH_PREVIEW_SIZE,
  fonts: [
    manropeNormalFont,
    manropeBoldFont,
    jetbrainsMonoRegular,
    jetbrainsMonoSemi,
  ]
});
const resvg = new Resvg(Buffer.from(svg));
const pngBuffer = resvg.render().asPng();
return send(event, pngBuffer, "image/png");
```

–í–æ—Ç –∏ –≤—Å–µ, —Ç–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ API –ø–æ —É—Ä–ª—É, –≥–¥–µ —Å –ø–æ–º–æ—â—å—é GET-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É–∫–∞–∂–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ API –æ—Ç–¥–∞—Å—Ç –Ω–∞–º –∫–∞—Ä—Ç–∏–Ω–∫—É.

[–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Ç–∞–∫–æ–π —Å—Å—ã–ª–∫–∏](https://tokiory.vercel.app/api/og?title=%255Bstation%255D%2520kioto&description=%25D0%259C%25D0%25B5%25D1%2581%25D1%2582%25D0%25BE%2520%25D0%25B3%25D0%25B4%25D0%25B5%2520%25D0%25BC%25D0%25BE%25D0%25B6%25D0%25BD%25D0%25BE%2520%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25B9%25D0%25BD%25D0%25BE%2520%25D1%2581%25D0%25B5%25D1%2581%25D1%2582%25D1%258C%2520%25D0%25B8%2520%25D0%25BF%25D0%25BE%25D1%2587%25D0%25B8%25D1%2582%25D0%25B0%25D1%2582%25D1%258C%2520%25D0%25BE%2520%25D1%2580%25D0%25B0%25D0%25B7%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D0%25BA%25D0%25B5.&url=%2522http%253A%252F%252Flocalhost%253A3000%252F%2522&gradient=green)

# Composable
–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ Nuxt –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–ª–∏ –≤ —Å–µ–±—è Open Graph –º–µ—Ç–∞-—Ç–µ–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —É–∫–∞–∂–µ–º.
–ú—ã –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é composable.

::ContentBookmark{url="https://nuxt.com/docs/guide/directory-structure/composables"}
::

–í–Ω–∏–∑—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –ø–æ–ª–Ω—ã–π –ª–∏—Å—Ç–∏–Ω–≥ –Ω–∞—à–µ–≥–æ composable:

```typescript[useOpenGraph.ts]
import type { PreviewTemplate } from "@/types/preview.types";
import { OPEN_GRAPH_PREVIEW_SIZE } from "~/constants/openGraph";

/**
 * Utility for generation OG Preview URL
 * @param rootUrl URL of the site
 * @param params Preview parameters
 * @returns URL
 */
const generatePreviewURL = (rootUrl: string, params: PreviewTemplate): string => {
  const title = encodeURIComponent(params.title);
  const description = encodeURIComponent(params.description);
  const url = encodeURIComponent(params.url);
  const queryParams = new URLSearchParams({
    title,
    description,
    url,
  });


  if (params.subtitle) {
    queryParams.append(
      "subtitle",
      encodeURIComponent(params.subtitle)
    );
  }

  if (params.gradient) {
    queryParams.append("gradient", params.gradient);
  }

  return `${rootUrl}/api/og?${queryParams.toString()}`;
};

/**
 * Include Open Graph meta tags (and twitter tooüê¶) into page head tag
 * @param title Title of the page
 * @param subtitle Subtitle of the page
 * @param description Description of the page
 * @param gradient Gradient to use
 */
export const useOpenGraph = async ({ description, gradient, title, subtitle }: Omit<PreviewTemplate, "url">) => {
  const route = useRoute();
  const config = useRuntimeConfig();
  const url = `"${config.public.URL}${route.path}"`;

  debugDo(() => {
    console.groupCollapsed("useOpenGraph.ts: Preview of generated API URL");
    console.log("URL", generatePreviewURL(config.public.URL, { description, url, title, gradient, subtitle }));
    console.groupEnd();
  });

  const previewSizeMeta = Object.keys(OPEN_GRAPH_PREVIEW_SIZE).map(key => {
    return {
      property: `og:image:${key}`,
      content: OPEN_GRAPH_PREVIEW_SIZE[
        key as keyof typeof OPEN_GRAPH_PREVIEW_SIZE
        ].toString()
    };
  });

  const previewURL = generatePreviewURL(config.public.URL, { description, gradient, title, subtitle, url });

  useHead({
    meta: [
      // Twitter OG
      {
        property: "twitter:card",
        content: "summary_large_image",
      },
      {
        property: "twitter:image",
        content: previewURL
      },

      // Basic OG
      {
        property: "og:description",
        content: description,
      },
      {
        property: "og:title",
        content: title,
      },
      {
        property: "og:image",
        content: previewURL
      },
      ...previewSizeMeta,
    ]
  });
};
```

## –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ URL'–∞ –¥–ª—è Open Graph Image

–ù–∞–º –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏ –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç –Ω–∞—à–µ–≥–æ API, –ø—Ä–∏—á–µ–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Ç–∞–∫, —á—Ç–æ–±—ã
–≤ URL'–µ –±—ã–ª–∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –≠—Ç–∏–º –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `generatePreviewURL`:

```typescript
/**
 * Utility for generation OG Preview URL
 * @param rootUrl URL of the site
 * @param params Preview parameters
 * @returns URL
 */
const generatePreviewURL = (rootUrl: string, params: PreviewTemplate): string => {
  const title = encodeURIComponent(params.title);
  const description = encodeURIComponent(params.description);
  const url = encodeURIComponent(params.url);
  const queryParams = new URLSearchParams({
    title,
    description,
    url,
  });


  if (params.subtitle) {
    queryParams.append(
      "subtitle",
      encodeURIComponent(params.subtitle)
    );
  }

  if (params.gradient) {
    queryParams.append("gradient", params.gradient);
  }

  return `${rootUrl}/api/og?${queryParams.toString()}`;
};
```

> –ú—ã –º–æ–∂–µ–º —É–≤–∏–¥–µ—Ç—å —á—Ç–æ —Ç—É—Ç –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é `encodeURIComponent`, –∫–æ—Ç–æ—Ä–∞—è –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –∏ —Å–ø–µ—Ü. —Å–∏–º–≤–æ–ª—ã
> –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ URL'–µ. –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É
> [–º—ã –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–ª–∏](http://localhost:3000/article/satori-og#–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-—Ç–µ–º–ø–ª–µ–π—Ç–∞) –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –ø—Ä–∏—à–ª–∏.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–∫–∏
–í —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ –Ω–∞—à–µ–≥–æ composable –º—ã –ø—Ä–æ–≤–æ–¥–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª—Å—è URL. `debugDo` - —É—Ç–∏–ª–∏—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç
–ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –∫–æ–ª–ª–±—ç–∫ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ `process.dev === true`:

```typescript
/**
 * Include Open Graph meta tags (and twitter tooüê¶) into page head tag
 * @param title Title of the page
 * @param subtitle Subtitle of the page
 * @param description Description of the page
 * @param gradient Gradient to use
 */
export const useOpenGraph = async ({ description, gradient, title, subtitle }: Omit<PreviewTemplate, "url">) => {
  const route = useRoute();
  const config = useRuntimeConfig();
  const url = `"${config.public.URL}${route.path}"`;

  debugDo(() => {
    console.groupCollapsed("useOpenGraph.ts: Preview of generated API URL");
    console.log("URL", generatePreviewURL(config.public.URL, {description, url, title, gradient, subtitle}));
    console.groupEnd();
  });
  // ...
}
```

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–≥–æ–≤ –¥–ª—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏
–í Open Graph —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–µ—Ç–∞-—Ç–µ–≥–∞ –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è –ø—Ä–µ–≤—å—é, —É —ç—Ç–∏—Ö —Ç–µ–≥–æ–≤ —Å–ª–µ–¥—É—é—â–∏–µ `property`:
- `og:image:width`;
- `og:image:height`.

–í –¥–∞–Ω–Ω–æ–º –ª–∏—Å—Ç–∏–Ω–≥–µ –º—ã —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –º–µ—Ç–∞-—Ç–µ–≥–∏:

```typescript
// OPEN_GRAPH_PREVIEW_SIZE –±—ã–ª –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∏ –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:
// export const OPEN_GRAPH_PREVIEW_SIZE = {
//   width: 1200,
//   height: 630
// };

const previewSizeMeta = Object.keys(OPEN_GRAPH_PREVIEW_SIZE).map(key => {
  return {
    property: `og:image:${key}`,
    content: OPEN_GRAPH_PREVIEW_SIZE[
      key as keyof typeof OPEN_GRAPH_PREVIEW_SIZE
      ].toString()
  };
});
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞-—Ç–µ–≥–æ–≤
–¢–µ–ø–µ—Ä—å –Ω–∞–º –æ—Å—Ç–∞–ª–æ—Å—å –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π composable - `useHead`, –∫–æ—Ç–æ—Ä—ã–π –≤—Å—Ç–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ç–µ–≥–∏ –≤ `<head>`.

> –°—Ç–æ–∏—Ç —É–ø–æ–º—è–Ω—É—Ç—å, —á—Ç–æ `useHead` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤ Nuxt, –Ω–æ –≤ –¥—Ä—É–≥–∏—Ö SSR-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö –µ—Å—Ç—å –µ–≥–æ –∞–Ω–∞–ª–æ–≥–∏.

```typescript
const previewURL = generatePreviewURL(config.public.URL, { description, gradient, title, subtitle, url });

useHead({
  meta: [
    // Twitter OG
    {
      property: "twitter:card",
      content: "summary_large_image",
    },
    {
      property: "twitter:image",
      content: previewURL
    },

    // Basic OG
    {
      property: "og:description",
      content: description,
    },
    {
      property: "og:title",
      content: title,
    },
    {
      property: "og:image",
      content: previewURL
    },
    ...previewSizeMeta,
  ]
});
```

–ö—Ä–æ–º–µ Open Graph –ø—Ä–µ–≤—å—é –º—ã —Ç–∞–∫–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏ –ø—Ä–µ–≤—å—é –¥–ª—è —Ç–≤–∏—Ç—Ç–µ—Ä–∞, —Ç–∞–∫ –∫–∞–∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∞–π—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–≥–æ.

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–≥–æ —á—Ç–æ –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏
–¢–µ–ø–µ—Ä—å –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–≤—å—é –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å composable `useOpenGraph`
–≤–Ω—É—Ç—Ä–∏ –ª—é–±–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

```vue
<script lang="ts" setup>
useOpenGraph({
  title: "–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",
  subtitle: "–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",
  description: "–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",
  gradient: "red",
});
</script>
```
